-- Mubashir AutoJoiner | Full GUI + Mobile + Dragging + Buttons

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer

-- GUI
local MubashirAutojoiner = Instance.new("ScreenGui")
MubashirAutojoiner.Name = "Mubashir AutoJoiner"
MubashirAutojoiner.Parent = player:WaitForChild("PlayerGui")
MubashirAutojoiner.IgnoreGuiInset = true
MubashirAutojoiner.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local Screen = Instance.new("Frame")
Screen.Parent = MubashirAutojoiner
Screen.Size = UDim2.fromScale(1,1)
Screen.BackgroundTransparency = 1

-- MAIN FRAME
local Main = Instance.new("Frame")
Main.Parent = Screen
Main.Size = UDim2.new(0,165,0,220)
Main.AnchorPoint = Vector2.new(0.5,0.5)
Main.Position = UDim2.fromScale(0.5,0.5)
Main.BackgroundColor3 = Color3.fromRGB(45,45,45)
Instance.new("UICorner",Main).CornerRadius = UDim.new(0,3)

-- TITLE
local Title = Instance.new("TextLabel")
Title.Parent = Main
Title.Size = UDim2.new(0,130,0,50)
Title.Position = UDim2.new(0.10,0,-0.03,0)
Title.BackgroundTransparency = 1
Title.Font = Enum.Font.GothamBold
Title.Text = "Mubashir AutoJoiner"
Title.TextColor3 = Color3.new(1,1,1)
Title.TextSize = 14
local UIGradient_Title = Instance.new("UIGradient", Title)
UIGradient_Title.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(0,132,255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(13,16,161))
}

-- EXTRAS LABEL
local Extras = Instance.new("TextLabel")
Extras.Parent = Main
Extras.Size = UDim2.new(0,88,0,50)
Extras.Position = UDim2.new(0.23,0,0.38,0)
Extras.BackgroundTransparency = 1
Extras.Font = Enum.Font.GothamBold
Extras.Text = "Extras"
Extras.TextColor3 = Color3.fromRGB(65,122,255)
Extras.TextSize = 14
local UIGradient_Extras = Instance.new("UIGradient", Extras)
UIGradient_Extras.Color = UIGradient_Title.Color

-- BUTTON CREATOR
local function createButton(name,text,posY)
    local b = Instance.new("TextButton")
    b.Name = name
    b.Parent = Main
    b.Size = UDim2.new(0,148,0,27)
    b.Position = UDim2.new(0.048,0,posY,0)
    b.BackgroundColor3 = Color3.fromRGB(66,66,66)
    b.Font = Enum.Font.GothamBold
    b.Text = text
    b.TextColor3 = Color3.fromRGB(255,255,255)
    b.TextSize = 14
    Instance.new("UICorner",b).CornerRadius = UDim.new(0,3)
    return b
end

local AutoJoin = createButton("AutoJoin","Auto Join",0.15)
local Mps = createButton("Mps","MPS : 20M/s",0.30)
local SecretESP = createButton("SecretESP","Secret ESP",0.56)
local WatermarkBtn = createButton("Watermark","Watermark",0.70)

-- FOOTER LABEL
local Tiktok = Instance.new("TextLabel")
Tiktok.Parent = Main
Tiktok.Size = UDim2.new(0,130,0,50)
Tiktok.Position = UDim2.new(0.10,0,0.80,0)
Tiktok.BackgroundTransparency = 1
Tiktok.Font = Enum.Font.Gotham
Tiktok.Text = "by Mubashir"
Tiktok.TextColor3 = Color3.fromRGB(175,175,175)
Tiktok.TextSize = 14
local UIGradient_Tiktok = Instance.new("UIGradient", Tiktok)
UIGradient_Tiktok.Color = UIGradient_Title.Color

-- WATERMARK FRAME
local WaterMark = Instance.new("Frame")
WaterMark.Parent = Screen
WaterMark.Size = UDim2.new(0,235,0,70)
WaterMark.AnchorPoint = Vector2.new(0.5,0)
WaterMark.Position = UDim2.fromScale(0.5,0.02)
WaterMark.BackgroundTransparency = 1

local WMTitle = Instance.new("TextLabel")
WMTitle.Parent = WaterMark
WMTitle.Size = UDim2.new(0,200,0,50)
WMTitle.Position = UDim2.new(0.07,0,-0.09,0)
WMTitle.BackgroundTransparency = 1
WMTitle.Font = Enum.Font.GothamBold
WMTitle.Text = "Mubashir AutoJoiner"
WMTitle.TextColor3 = Color3.fromRGB(65,122,255)
WMTitle.TextSize = 27
local UIGradient_WM = Instance.new("UIGradient", WMTitle)
UIGradient_WM.Color = UIGradient_Title.Color

local WMTiktok = Instance.new("TextLabel")
WMTiktok.Parent = WaterMark
WMTiktok.Size = UDim2.new(0,200,0,50)
WMTiktok.Position = UDim2.new(0.07,0,0.27,0)
WMTiktok.BackgroundTransparency = 1
WMTiktok.Font = Enum.Font.Gotham
WMTiktok.Text = "by Mubashir"
WMTiktok.TextColor3 = Color3.fromRGB(175,175,175)
WMTiktok.TextSize = 14
local UIGradient_WMTiktok = Instance.new("UIGradient", WMTiktok)
UIGradient_WMTiktok.Color = UIGradient_Title.Color

-- DRAGGING
local dragging = false
local dragStart, startPos
Main.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = Main.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

UIS.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        Main.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

-- MPS BUTTON
local mpsValues = {10,20,50,100,500}
local currentIndex = 2
Mps.MouseButton1Click:Connect(function()
    currentIndex += 1
    if currentIndex > #mpsValues then currentIndex = 1 end
    Mps.Text = "MPS : "..mpsValues[currentIndex].."M/s"
end)

-- WATERMARK TOGGLE
local watermarkVisible = true
WatermarkBtn.MouseButton1Click:Connect(function()
    watermarkVisible = not watermarkVisible
    WaterMark.Visible = watermarkVisible
end)

-- AUTOJOIN
AutoJoin.MouseButton1Click:Connect(function()
    local PLACE_ID = 109983668079237
    local servers = {}

    pcall(function()
        local url = "https://games.roblox.com/v1/games/"..PLACE_ID.."/servers/Public?sortOrder=Asc&limit=100"
        local response = game:HttpGet(url)
        local data = HttpService:JSONDecode(response)

        if data and data.data then
            for _,v in pairs(data.data) do
                if v.playing < v.maxPlayers then
                    table.insert(servers,v.id)
                end
            end
        end
    end)

    if #servers > 0 then
        TeleportService:TeleportToPlaceInstance(
            PLACE_ID,
            servers[math.random(1,#servers)],
            player
        )
    else
        warn("No free servers found!")
    end
end)
